[test]
name = layer_pgzip_jobs2
description = Create a gzip layer using pgzip with 2 jobs and low compression level

[file]
name = hello.txt
Hello parallel gzip

[command]
subcommand = layer
args = --add /hello.txt=hello.txt --format gzip --compressor-jobs 2 --compression-level 1 --metadata layer_meta.json layer.tgz
expect_exit = 0

[assert]
file_exists = layer.tgz
file_valid_gzip = layer.tgz
file_exists = layer_meta.json
file_valid_json = layer_meta.json
file_contains = layer_meta.json, "tar+gzip"
tar_entry_exists = layer.tgz, hello.txt
tar_entry_type = layer.tgz, hello.txt, link
