[test]
name = layer_gzip_level9_singlethread
description = Create a gzip layer using single-threaded stdlib gzip with high compression level

[file]
name = big.txt
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam.

[command]
subcommand = layer
args = --add /big.txt=big.txt --format gzip --compressor-jobs 1 --compression-level 9 --metadata layer_meta.json layer.tgz
expect_exit = 0

[assert]
file_exists = layer.tgz
file_valid_gzip = layer.tgz
file_exists = layer_meta.json
file_valid_json = layer_meta.json
file_contains = layer_meta.json, "tar+gzip"
tar_entry_exists = layer.tgz, big.txt
tar_entry_type = layer.tgz, big.txt, link
