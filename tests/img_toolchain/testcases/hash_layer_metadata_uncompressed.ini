[test]
name = hash_layer_metadata_uncompressed
description = Test hash command with layer-metadata encoding on uncompressed tar

[testdata]
copy = layer.tar=img_toolchain/hash_tests/test_layer_uncompressed.tar

[command]
subcommand = hash
args = --encoding=layer-metadata --name=test-layer layer.tar metadata.json
expect_exit = 0

[assert]
file_exists = metadata.json
file_valid_json = metadata.json
json_field_exists = metadata.json, name
json_field_exists = metadata.json, digest
json_field_exists = metadata.json, diff_id
json_field_exists = metadata.json, size
json_field_exists = metadata.json, mediaType
json_field_equals = metadata.json, name, test-layer
json_field_equals = metadata.json, mediaType, application/vnd.oci.image.layer.v1.tar
