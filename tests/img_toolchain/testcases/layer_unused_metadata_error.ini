[test]
name = layer_unused_metadata_error
description = Test that layer command errors when file metadata is unused

[file]
name = test.txt
Hello World

[command]
subcommand = layer
args = --file-metadata nonexistent/file.txt={"mode":"0644"} --file-metadata another/missing.txt={"mode":"0755"} --add test.txt=test.txt layer.tgz
expect_exit = 1
expect_stderr_contains = unused file metadata for paths: another/missing.txt, nonexistent/file.txt

[assert]
file_exists = layer.tgz
