# See https://docs.aspect.build/workflows/configuration
---
tasks:
    # Note: we don't support Bazel 6 or earlier
    - test:
          name: Bazel 8
          id: bazel-8
          env:
              USE_BAZEL_VERSION: 8.x
          targets:
              - "//..."
              - "@rules_img_tool//..."
              - "@rules_img_pull_tool//..."
    - test:
          name: Integration Tests
          id: integration-tests
          targets: ["//e2e:integration_tests"]
    # TODO(malte): enable Bazel 9 when green
    # - test:
    #       name: Bazel 9
    #       id: bazel-9
    #       env:
    #           USE_BAZEL_VERSION: rolling
    - buildifier:
        queue: aspect-small
        target: //util:buildifier.check
notifications:
    github: {}
